.chess-board {
    display: grid;
    grid-template-columns: auto 1fr;
    grid-template-rows: 1fr auto;
    gap: 0.25rem;
    padding: 1rem 0 1rem 1rem;
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    backdrop-filter: blur(10px);
    border-radius: 1.25rem;
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
    align-self: center;
    height: fit-content;
}

.rank-labels {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    padding-right: 0.5rem;
}

.rank-label,
.file-label {
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    font-weight: 700;
    color: var(--color-text-secondary);
    user-select: none;
    opacity: 0.8;
}

.file-labels {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    grid-column: 2;
    padding-top: 0.5rem;
}

.board-grid {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    grid-template-rows: repeat(8, 1fr);
    gap: 0;
    /* Occupy as much space as possible while remaining square and fitting in viewport */
    width: var(--board-size);
    height: var(--board-size);
    border: 4px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.6rem;
    overflow: hidden;
    background: rgba(0, 0, 0, 0.2);
}

.square {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    user-select: none;
}

.square:hover {
    filter: brightness(1.2);
}

.piece {
    font-size: clamp(2rem, 8vh, 5.5rem);
    transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    pointer-events: none;
    line-height: 1;
    z-index: 2;
}

.square:hover .piece {
    transform: scale(1.1) translateY(-2px);
}

.piece.draggable {
    cursor: grab;
    pointer-events: auto !important;
}

.piece.draggable:active {
    cursor: grabbing;
}

.piece.dragging {
    pointer-events: none;
    z-index: 1000;
}

/* Piece Set Specifics */
.pieces-minimal .piece {
    font-weight: 900;
    font-family: 'Inter', sans-serif;
}

.pieces-abstract .piece {
    font-size: clamp(1.5rem, 6vh, 4.5rem);
}

.pieces-neo .piece {
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

.selected {
    box-shadow: inset 0 0 0 5px rgba(255, 215, 0, 0.9);
    z-index: 3;
}

/* Valid Move Indicators */
.valid-move-indicator {
    position: absolute;
    width: 25%;
    height: 25%;
    background: rgba(0, 0, 0, 0.15);
    border-radius: 50%;
    z-index: 4;
    pointer-events: none;
}

.square:hover .valid-move-indicator {
    background: rgba(0, 0, 0, 0.25);
    transform: scale(1.2);
}

.square.has-piece .valid-move-indicator {
    width: 80%;
    height: 80%;
    background: transparent;
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-radius: 50%;
}

.theme-modern .valid-move-indicator {
    background: rgba(255, 255, 255, 0.3);
}

.theme-modern .square.has-piece .valid-move-indicator {
    border-color: rgba(255, 255, 255, 0.2);
}

/* Last Move Highlighting */
.last-move::after {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(100, 180, 255, 0.3);
    pointer-events: none;
    z-index: 1;
}

.last-move-to::after {
    background: rgba(50, 200, 180, 0.35);
    animation: lastMovePulse 2s ease-in-out infinite;
}

@keyframes lastMovePulse {

    0%,
    100% {
        background: rgba(50, 200, 180, 0.35);
    }

    50% {
        background: rgba(50, 200, 180, 0.2);
    }
}

/* Themes */
.theme-classic .square.light {
    background: #f0d9b5;
}

.theme-classic .square.dark {
    background: #b58863;
}

.theme-classic .piece.white {
    color: #ffffff;
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.theme-classic .piece.black {
    color: #000000;
    text-shadow: 0 2px 4px rgba(255, 255, 255, 0.2);
}

.theme-modern .square.light {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.theme-modern .square.dark {
    background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
}

.theme-modern .piece.white {
    color: #ffffff;
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.7);
}

.theme-modern .piece.black {
    color: #1a1a1a;
    text-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
}

.theme-minimal .square.light {
    background: #ffffff;
}

.theme-minimal .square.dark {
    background: #cbd5e1;
}

.theme-minimal .piece.white {
    color: #1e293b;
}

.theme-minimal .piece.black {
    color: #0f172a;
}

.theme-wooden .square.light {
    background: #e5c07b;
    background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
}

.theme-wooden .square.dark {
    background: #78350f;
    background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
}

.theme-wooden .piece.white {
    color: #fffbeb;
    text-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
}

.theme-wooden .piece.black {
    color: #2d1a0b;
    text-shadow: 0 2px 5px rgba(255, 255, 255, 0.2);
}

/* Responsive */
@media (max-width: 1000px) {
    .board-grid {
        width: min(80vw, 500px);
        height: min(80vw, 500px);
    }

    .piece {
        font-size: clamp(1.5rem, 8vw, 3.5rem);
    }

    .chess-board {
        margin-top: 0;
        padding: 0.75rem 0 0.75rem 0.75rem;
    }
}

@media (max-width: 768px) {
    .board-grid {
        width: min(85vw, 400px);
        height: min(85vw, 400px);
    }

    .piece {
        font-size: clamp(1.2rem, 7vw, 2.8rem);
    }

    .chess-board {
        padding: 0.5rem 0 0.5rem 0.5rem;
        border-radius: 1rem;
    }

    .rank-label,
    .file-label {
        font-size: 0.8rem;
    }
}

@media (max-width: 480px) {
    .board-grid {
        width: min(90vw, 350px);
        height: min(90vw, 350px);
        border-width: 2px;
    }

    .piece {
        font-size: clamp(1rem, 6vw, 2.2rem);
    }

    .chess-board {
        padding: 0.4rem 0 0.4rem 0.4rem;
        gap: 0.15rem;
    }

    .rank-label,
    .file-label {
        font-size: 0.7rem;
    }

    .rank-labels {
        padding-right: 0.3rem;
    }

    .file-labels {
        padding-top: 0.3rem;
    }
}